<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Időpontfoglalás</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; }
    .container { max-width: 600px; margin-top: 50px; }
  </style>
</head>
<body>
  <div class="container">
    <h2 class="mb-4 text-center">Időpontfoglalás</h2>
    <form id="bookingForm">
      <div class="mb-3">
        <label for="business" class="form-label">Szolgáltatás típusa</label>
        <select class="form-select" id="business" name="business">
          <option value="masszazs">Masszázs</option>
          <option value="fodrasz">Fodrász</option>
          <option value="kozmetika">Kozmetika</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="name" class="form-label">Név</label>
        <input type="text" class="form-control" id="name" name="name" required>
      </div>
      <div class="mb-3">
        <label for="phone" class="form-label">Telefonszám</label>
        <input type="tel" class="form-control" id="phone" name="phone" required>
      </div>
      <div class="mb-3">
        <label for="email" class="form-label">Email</label>
        <input type="email" class="form-control" id="email" name="email" required>
      </div>
      <div class="mb-3">
        <label for="date" class="form-label">Dátum</label>
        <input type="text" class="form-control" id="date" name="date" required>
      </div>
      <div class="mb-3">
        <label for="time" class="form-label">Időpont</label>
        <select class="form-select" id="time" name="time" required>
          <option value="">Válassz időpontot</option>
        </select>
      </div>
      <button type="submit" class="btn btn-primary w-100">Foglalás</button>
    </form>
    <div id="confirmation" class="alert alert-success mt-4 d-none">Foglalás sikeres!</div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script>
    flatpickr("#date", {
      dateFormat: "Y-m-d",
      minDate: "today",
      onChange: function(selectedDates, dateStr) {
        const business = document.getElementById("business").value;
        fetchAvailableTimes(business, dateStr);
      }
    });

    document.getElementById("business").addEventListener("change", () => {
      const date = document.getElementById("date").value;
      if (date) {
        fetchAvailableTimes(document.getElementById("business").value, date);
      }
    });

    function fetchAvailableTimes(business, date) {
      // Itt cseréld le a fetch URL-t a saját backend API végpontodra
      fetch(`/api/available-times?business=${business}&date=${date}`)
        .then(response => response.json())
        .then(data => {
          const timeSelect = document.getElementById("time");
          timeSelect.innerHTML = '<option value="">Válassz időpontot</option>';
          data.times.forEach(time => {
            const option = document.createElement("option");
            option.value = time;
            option.textContent = time;
            timeSelect.appendChild(option);
          });
        });
    }

    document.getElementById("bookingForm").addEventListener("submit", function(e) {
      e.preventDefault();
      // Itt küldheted el a foglalást a backendnek
      document.getElementById("confirmation").classList.remove("d-none");
      this.reset();
    });
  </script>
</body>
</html>
